
var timerThread=null;var count=21;var isDebug=true;var chartData=0;var preChartData=0;if(typeof(jsonObject.channel)!=="undefined"&&jsonObject.channel){var get_channel=$.parseJSON($.base64.decode(jsonObject.channel))}var listPageSet={totalcount:0,rowlimit:0,current_page:1,page_block:5,total_page:null,total_block:null,current_block:null};var listPageSet2={totalcount:0,rowlimit:0,current_page:1,page_block:5,total_page:null,total_block:null,current_block:null};var tradePageSet={code:"buy",defaultSet:0,float_market_price:0,float_amount:0,float_total:0,int_total:0,order_status:false,arrow_krw_status:false,arrow_coin_status:false,arrow_krw_sell_status:false,arrow_coin_sell_status:false,trade_info_fee:0,trade_fee:0,trade_maker_fee:0,trade_tracker_fee:0,trade_receipt_btc:0,trade_krw_min_limit:0,trade_coin_min_limit:0,trade_call_unit_krw:0,trade_call_unit_coin:0,};var domObjSet={defaultSet:0,fromarea:$("#order-form-area"),only_coin:$("#order-form-area .only-coin"),buy_amount:$("#order-form-buy input[name='input_amount']"),buy_price:$("#order-form-buy input[name='input_price']"),buy_total:$("#order-form-buy input[name='input_total']"),buy_fee:$("#order-form-buy #trade_fee"),buy_receipt:$("#order-form-buy #trade_receipt"),sell_amount:$("#order-form-sell input[name='input_amount']"),sell_price:$("#order-form-sell input[name='input_price']"),sell_total:$("#order-form-sell input[name='input_total']"),sell_fee:$("#order-form-sell #trade_fee"),sell_receipt:$("#order-form-sell #trade_receipt"),btn_buy_submit:$("#btn_buy_submit"),btn_sell_submit:$("#btn_sell_submit"),token:$('#order-form-area input[name="token"]'),};var statusListVisible={list_my_trade:false,list_open_order:true,};var setInputCalculationBuySell=function(b){var a=domObjSet.buy_price;var c=domObjSet.buy_amount;if(b=="buy"){}else{if(b=="sell"){a=domObjSet.sell_price;c=domObjSet.sell_amount}}if(a.val()){tradePageSet.float_market_price=calfloat("ROUND",a.val().replace(/[^0-9]/g,""),8)}else{tradePageSet.float_market_price=0}if(c.val()){tradePageSet.float_amount=calfloat("FLOOR",c.val(),8)}else{tradePageSet.float_amount=0}};var setTotalCalculationBuySell=function(d,b){var e=domObjSet.buy_amount;var a=domObjSet.buy_total;var c=domObjSet.buy_fee;var f=domObjSet.buy_receipt;if(d=="buy"){}else{if(d=="sell"){e=domObjSet.sell_amount;a=domObjSet.sell_total;c=domObjSet.sell_fee;f=domObjSet.sell_receipt}}if(b=="total"){a.val(a.val().replace(/[^0-9]/g,""));if(a.val()){tradePageSet.float_total=calfloat("FLOOR",a.val(),8)}else{tradePageSet.float_total=0}if(Number(tradePageSet.float_total)>1e-8&&tradePageSet.float_market_price>0){tradePageSet.float_amount=calfloat("ROUND",tradePageSet.float_total/tradePageSet.float_market_price,8);e.val((tradePageSet.float_amount).toString().formatBitcoin())}else{tradePageSet.float_amount=0;e.val("0.00000000")}}else{if(Number(tradePageSet.float_market_price)>0&&Number(tradePageSet.float_amount)>0){tradePageSet.float_total=calfloat("ROUND",tradePageSet.float_market_price*tradePageSet.float_amount);if(tradePageSet.float_total<1e-8){tradePageSet.float_total=0}a.val(tradePageSet.float_total.formatWon());if(d=="buy"){c.html((domObjSet.buy_amount.val()*tradePageSet.trade_maker_fee/100).formatBitcoin());f.html("≈ "+(domObjSet.buy_amount.val()-domObjSet.buy_amount.val()*tradePageSet.trade_maker_fee/100).formatBitcoin())}else{if(d=="sell"){c.html((a.val().replace(/[^0-9]/g,"")*tradePageSet.trade_maker_fee/100).formatWon());f.html("≈ "+(tradePageSet.float_total-tradePageSet.float_total*tradePageSet.trade_maker_fee/100).formatWon())}}}else{a.val("");c.val("");f.val("")}}};var displayInputAmount=function(){if(domObjSet.buy_price.is(":focus")||domObjSet.buy_amount.is(":focus")){tradePageSet.code="buy";setInputCalculationBuySell("buy");setTotalCalculationBuySell("buy")}else{if(domObjSet.buy_total.is(":focus")){tradePageSet.code="buy";setInputCalculationBuySell("buy");setTotalCalculationBuySell("buy","total")}else{if(domObjSet.sell_price.is(":focus")||domObjSet.sell_amount.is(":focus")){tradePageSet.code="sell";setInputCalculationBuySell("sell");setTotalCalculationBuySell("sell")}else{if(domObjSet.sell_total.is(":focus")){tradePageSet.code="sell";setInputCalculationBuySell("sell");setTotalCalculationBuySell("sell","total")}else{if(tradePageSet.code=="buy"){setInputCalculationBuySell("buy");setTotalCalculationBuySell("buy")}else{if(tradePageSet.code=="sell"){setInputCalculationBuySell("sell");setTotalCalculationBuySell("sell")}}}}}}};var orderSubmit=function(a){Account.isLogined(function(d){if(d){a.button("loading");displayInputAmount();var b={result:0,link:{proc:"/gettradeorder"+get_channel.currency+"/regist/"}};controllerForm.setBeanData(b);var c=domObjSet.token.val();controllerForm.modeldata={od_action:tradePageSet.code,od_pay_status:"REQ",od_market_price:tradePageSet.float_market_price,od_total_cost:tradePageSet.float_total,od_temp_coin:tradePageSet.float_amount,channel:get_channel.ch,currency:get_channel.currency,token:c};controllerForm.setOnComplet=function(e){if(e&&e!="undefined"&&e.result!="undefined"){if(typeof(e.token)!="undeinfed"){if(domObjSet.token.length>0){domObjSet.token.val(e.token)}}if(Number(e.result)>0){var g=(get_channel.currency+"").toUpperCase();var f="<p>"+langConvert("lang.msgxxBtcHasBeenCompletedPurchaseOrderRequest",[(tradePageSet.float_amount)+""+g])+"</p><p>"+langConvert("lang.msgUsedThanks","")+"</p>";if(typeof e.complete!="undefined"){if(e.complete=="OK"){f="<p>"+langConvert("lang.msgxxBtcPurchaseRequestOrderHasBeenSigned",[(tradePageSet.float_amount)+""+g])+"</p><p>"+langConvert("lang.msgUsedThanks","")+"</p>"}else{if(e.complete=="PART"){f="<p>"+langConvert("lang.msgxxBtcWasSignedThisPurchaseOrderRequestSection",[(tradePageSet.float_amount)+""+g])+"</p><p>"+langConvert("lang.msgUsedThanks","")+"</p>"}else{if(e.complete=="WAIT"){f="<p>"+langConvert("lang.msgxxBtcIsOneOfOrdersSignedPurchaseRequestProcess",[(tradePageSet.float_amount)+""+g])+"</p><p>"+langConvert("lang.msgTradeCompleteNotityBottom","")+"<p/><p>"+langConvert("lang.msgUsedThanks","")+"</p>"}}}}listPageSet.current_page=1;initListData();controllerComm.alertError(f,function(){if(typeof e.complete=="undefined"||e.complete==""){}})}else{var h=(typeof e.error!="undefined")?e.error:langConvert("lang.msgExceptionsoccurred","");if(Number(e.result)==0){h=langConvert("lang.msgTryAgainLater","")}controllerComm.alertError("<p>"+h+"</p>",function(){if(e.result==-900){document.location.reload()}})}}else{controllerComm.alertError("<p>"+langConvert("lang.msgTradeFailedRequestOrders","")+"</p><p>"+langConvert("lang.msgTryAgainLater","")+"</p>",function(){document.location.reload()})}a.button("reset")};controllerForm.setInitForm("tradecoin")}else{controllerComm.alertError("<p>"+langConvert("lang.msgPleaseLogin","")+"</p>",function(){$(location).attr("href","/account/signin")})}})};$(domObjSet.btn_buy_submit).click(function(){tradePageSet.code="buy";var a=$(this);orderSubmit(a)});$(domObjSet.btn_sell_submit).click(function(){tradePageSet.code="sell";var a=$(this);orderSubmit(a)});function initListData(){Account.isLogined(function(b){if(b){var a=Utils.getTimeStamp();$.getJSON("/gettradeorder"+get_channel.currency+"/envlistopenordershort/t-"+a,"",function(c){}).done(function(d){var c=(d)?d.length:0;for(i=0;i<c;i++){if(typeof(d[i].rowlimit)=="undefined"){}else{listPageSet.totalcount=parseInt(d[0].totalcount);listPageSet.rowlimit=parseInt(d[0].rowlimit);listPageSet.total_page=calfloat("CEIL",listPageSet.totalcount/listPageSet.rowlimit,0);listPageSet.total_block=calfloat("CEIL",listPageSet.total_page/listPageSet.page_block,0);listPageSet.current_block=calfloat("CEIL",(listPageSet.current_page)/listPageSet.page_block,0);var e=(($("#list-uncomplet-page").length>0)?($("#list-uncomplet-page").offset().top):false);init_pager(getListOpenorder,e)}}setTimeout("getListOpenorder()",100)});$.getJSON("/gettradeorder"+get_channel.currency+"/envliststradecompleteshort/t-"+a,"",function(c){}).done(function(d){var c=(d)?d.length:0;for(i=0;i<c;i++){if(typeof(d[i].rowlimit)=="undefined"){}else{listPageSet2.totalcount=parseInt(d[0].totalcount);listPageSet2.rowlimit=parseInt(d[0].rowlimit);listPageSet2.total_page=calfloat("CEIL",listPageSet2.totalcount/listPageSet2.rowlimit,0);listPageSet2.total_block=calfloat("CEIL",listPageSet2.total_page/listPageSet2.page_block,0);listPageSet2.current_block=calfloat("CEIL",(listPageSet2.current_page)/listPageSet2.page_block,0);var e=(($("#list-complet-page").length>0)?($("#list-complet-page").offset().top):false);init_pager_second(getListMyTradeComplet,e)}}setTimeout("getListMyTradeComplet()",200)})}})}function getListOpenorder(a){Account.isLogined(function(d){if(d){if(!a){a=1}var b=Utils.getTimeStamp();var c="t-"+b+"/&page="+a+"/";$.getJSON("/gettradeorder"+get_channel.currency+"/listsopenordershort/"+c,"",function(e){}).done(function(e){list_write_uncom_content(e)})}})}var list_write_uncom_content=function(e){var g=[];var h="";if(typeof(e)!="undefined"){if(parseInt(e[0].result)>0){for(var f=0;f<e.length;f++){var c="";var l=0;if(parseFloat(e[f].od_receipt_coin)>0){l=e[f].od_receipt_coin}else{l=0}var j=e[f].od_receipt_avg*e[f].od_receipt_coin;j=(parseInt(j)).toString().formatNumber();if((e[f].od_pay_status=="REQ")&&e[f].od_receipt_coin==0){c='<span class="od_id_o_btnc_'+e[f].od_id+'"><button type="button" class="btn-cancle" id="od_id_'+e[f].od_id+'" onClick="userTradeOrderCancel('+e[f].od_id+",'"+e[f].od_action+"')\">"+langConvert("lang.msgTradeOrdersCancel","")+"</button></span>"}else{if(parseFloat(e[f].od_receipt_coin)>0){c='<span class="od_id_o_btnc_'+e[f].od_id+'"><button type="button" class="btn-cancle" id="od_id_'+e[f].od_id+'" onClick="userTradeOrderCancel('+e[f].od_id+",'"+e[f].od_action+"')\">"+langConvert("lang.msgTradeOrdersCancel","")+"</button></span>"}else{c=langConvert("lang.commonTradeProgress","")+' <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>'}}h="<tr>";if(e[f].od_action=="buy"){h+='<td><span class="badge buy">'+langConvert("lang.commonBid","")+"</span></td>"}else{if(e[f].od_action=="sell"){h+='<td><span class="badge sell">'+langConvert("lang.commonAsk","")+"</span></td>"}}var k=e[f].od_reg_dt;k=k.substring(2,k.length);var d=k.split(" ");var a=d[0];var b=d[1];h+="<td>"+a+"<br class=only-m> "+b+"</td>";h+='<td><input type="hidden" maxlength="17" readonly="true" id="od_id_m_price_'+e[f].od_id+'" name="order_price" value="'+(e[f].od_market_price).toString()+'" data-price="'+(e[f].od_market_price).toString().formatNumber()+'"><span>'+(e[f].od_market_price).toString().formatNumber()+"</span></td>";h+='<td><input type="text" style="display:none;width:120px;" id="od_id_m_btc_'+e[f].od_id+'" class="inp input_modify input-modify-btc od_id_m_btc_'+e[f].od_id+'" name="order_btc" maxlength="17" value="'+parseFloat(e[f].od_temp_coin)+'" data-amount="'+parseFloat(e[f].od_temp_coin)+'"><span class="od_id_btc_'+e[f].od_id+'">'+e[f].od_temp_coin+"</span></td>";h+="<td>"+l+"</td>";h+="<td>"+(parseInt(e[f].od_receipt_avg)+"").toString().formatNumber()+"</td>";h+="<td>"+j+"</td>";h+="<td>"+c+"</td>";h+="</tr>";g.push(h)}}else{h='<tr><td colspan="9" height="60"><center>'+langConvert("lang.msgNoOrdersHaveAlreadyConcludedHistory","")+"</center></td></tr>";g.push(h)}}else{h='<tr><td colspan="9" height="60"><center>'+langConvert("lang.msgNoOrdersHaveAlreadyConcludedHistory","")+"</center></td></tr>";g.push(h)}$("table.list-tradenocomplete>tbody").html(g.join())};function getListMyTradeComplet(a){Account.isLogined(function(d){if(d){if(!a){a=1}var b=Utils.getTimeStamp();var c="t-"+b+"/&page="+a+"/";$.getJSON("/gettradeorder"+get_channel.currency+"/liststradecompleteshort/"+c,"",function(e){}).done(function(e){list_write_com_content(e)})}})}var list_write_com_content=function(f){var h=[];var j="";var l="";var k="";if(typeof(f)!="undefined"){if(parseInt(f[0].result)>0){for(var g=0;g<f.length;g++){var o=calfloat("FLOOR",f[g].od_total_cost,0);var d=parseFloat(f[g].od_receipt_fee);var b=parseFloat(f[g].od_receipt_avg)*parseFloat(f[g].od_receipt_coin);b=(b.toFixed(0)).formatNumber();if(f[g].od_action=="buy"){l='<td><span class="badge buy">'+langConvert("lang.commonBid","")+"</span></td>";d=d.toFixed(8)}else{if(f[g].od_action=="sell"){l='<td><span class="badge sell">'+langConvert("lang.commonAsk","")+"</span></td>";d=d.toFixed(0);d=(d+"").toString().formatNumber()}}var m=f[g].od_reg_dt;m=m.substring(2,m.length);var n=m.split(" ");var a=n[0];var c=n[1];var e=f[g].od_receipt_dt;e=e.substring(2,e.length);j='<tr id="'+f[g].od_action+"_"+f[g].od_id+'">';j+=l;j+="<td>"+a+"<br class=only-m> "+c+"</td>";j+="<td>"+(f[g].od_temp_coin)+"</td>";j+="<td>"+(parseInt(f[g].od_receipt_avg)+"").toString().formatNumber()+"</td>";j+="<td>"+b+"</td>";j+="<td>"+d+"</td>";j+="<td onClick=\"getComList('"+f[g].od_id+"','"+f[g].od_action+'\')" style="cursor:pointer"><i class=xi-plus-circle></i></td>';j+="</tr>";h.push(j)}}else{j='<tr><td colspan="9" height="60"><center>'+langConvert("lang.msgThereAreNoRecentTransactionHistory","")+"</center></td></tr>";h.push(j)}}else{j='<tr><td colspan="9" height="60"><center>'+langConvert("lang.msgThereAreNoRecentTransactionHistory","")+"</center></td></tr>";h.push(j)}$("table.list-tradecomplete>tbody").html(h.join())};function getComList(e,f,a){if(typeof a==="undefined"){a="com"}else{a="uncom"}if($("."+f+"_"+e+"_detail").length>0){var g=$("."+f+"_"+e+"_detail").css("display");if(g=="table-row"){$("."+f+"_"+e+"_detail").css("display","none")}else{$("."+f+"_"+e+"_detail").css("display","table-row")}}else{var d=get_channel.currency;var c=f+"_krw_"+d;var b="";$.getJSON("/gettradelist/select/odid-"+e+"/action-"+c+"/","",function(h){}).success(function(p){if(typeof(p)!=="undefined"){if(parseInt(p[0].result)>0){var n=1;for(var q=0;q<p.length;q++){var j=p[q].po_reg_dt;j=j.substring(2,j.length);var o=j.split(" ");var h=o[0];var l=o[1];var m=p[q].po_point;m=Math.abs(m);var r=parseFloat(m)/parseFloat(p[q].od_total_cost);if(a=="uncom"){b+='<tr class="more '+f+"_"+e+'_detail" style="display:table-row;">';b+="<td></td>";b+="<td>("+n+")"+h+"<br class=only-m> "+l+"</td>";b+="<td>"+p[q].od_total_cost+"</td>";b+="<td>"+calfloat("FLOOR",r,0).formatWon()+"</td>";b+="<td>"+parseInt(m).formatWon()+"</td>";b+="<td></td>";b+="</tr>"}else{b+='<tr class="more '+f+"_"+e+'_detail" style="display:table-row;">';b+="<td></td>";b+="<td>("+n+")"+h+"<br class=only-m> "+l+"</td>";b+="<td>"+p[q].od_total_cost+"</td>";b+="<td>"+calfloat("FLOOR",r,0).formatWon()+"</td>";b+="<td>"+parseInt(m).formatWon()+"</td>";b+="<td></td>";b+="<td></td>";b+="</tr>"}n++}}}else{}$("#"+f+"_"+e).after(b)})}}if(typeof(tradePageSet)!="undefined"&&typeof(tradePageSet.dom_btn_order)!="undefined"&&tradePageSet.dom_btn_order.length>0){tradePageSet.dom_btn_order.click(function(){Account.isLogined(function(a){if(a){tradePageSet.order_status=true;clearInterval(timerThread);if(tradePageSet.code=="buy"){$("#buyBtcModal").modal({backdrop:"static",keyboard:false})}else{if(tradePageSet.code=="sell"){$("#sellBtcModal").modal({backdrop:"static",keyboard:false})}}count=21;$(".show_remain_time").html(langConvert("lang.msgOrderPlacing","")+" "+langConvert("lang.msgPleaseWait",""));$("#btn_submit").attr("disabled",true);$(".show_krw").html(calfloat("FLOOR",tradePageSet.float_total,0).toString().formatWon());$(".show_btc").html(calfloat("FLOOR",tradePageSet.float_btc,8).toString().formatBitcoin());$(".show_price").html(calfloat("FLOOR",tradePageSet.float_price,0).toString().formatWon());if(tradePageSet.code=="buy"){$(".show_fee").html((tradePageSet.trade_fee).toFixed(8))}else{if(tradePageSet.code=="sell"){$(".show_fee").html((calfloat("FLOOR",tradePageSet.trade_fee,0)+"").toString().formatWon())}}$(".show_timer").html();timerThread=setInterval(function(){$("#btn_submit").attr("disabled",false);if(tradePageSet.order_status==true){tradePageSet.dom_btn_order.attr("disabled",true)}count--;$(".show_remain_time").html(langConvert("lang.commonRemainTime","")+" : "+count+langConvert("lang.commonDateSecond",""));if(count<=0){clearInterval(timerThread);$(".show_remain_time").html(langConvert("lang.msgOrderExpiredPleaseOrderAgain",""));$("#btn_submit").attr("disabled",true)}},1000)}else{controllerComm.alertError("<p>"+langConvert("lang.msgPleaseLogin","")+"</p>",function(){$(location).attr("href","/account/signin")})}})})}if(typeof(tradePageSet)!="undefined"&&typeof(tradePageSet.dom_btn_order_sell)!="undefined"&&tradePageSet.dom_btn_order_sell.length>0){tradePageSet.dom_btn_order_sell.click(function(){Account.isLogined(function(a){if(a){tradePageSet.order_status=true;tradePageSet.code="sell";clearInterval(timerThread);if(tradePageSet.code=="buy"){$("#buyBtcModal").modal({backdrop:"static",keyboard:false})}else{if(tradePageSet.code=="sell"){$("#sellBtcModal").modal({backdrop:"static",keyboard:false})}}count=21;$(".show_remain_time").html(langConvert("lang.msgOrderPlacing","")+" "+langConvert("lang.msgPleaseWait",""));$("#btn_submit").attr("disabled",true);$(".show_krw").html(calfloat("FLOOR",tradePageSet.float_total,0).toString().formatWon());$(".show_btc").html(calfloat("FLOOR",tradePageSet.float_btc,8).toString().formatBitcoin());$(".show_price").html(calfloat("FLOOR",tradePageSet.float_price,0).toString().formatWon());if(tradePageSet.code=="buy"){$(".show_fee").html((tradePageSet.trade_fee).toFixed(8))}else{if(tradePageSet.code=="sell"){$(".show_fee").html((calfloat("FLOOR",tradePageSet.trade_fee,0)+"").toString().formatWon())}}$(".show_timer").html();timerThread=setInterval(function(){$("#btn_submit").attr("disabled",false);if(tradePageSet.order_status==true){tradePageSet.dom_btn_order.attr("disabled",true)}count--;$(".show_remain_time").html(langConvert("lang.commonRemainTime","")+" : "+count+langConvert("lang.commonDateSecond",""));if(count<=0){clearInterval(timerThread);$(".show_remain_time").html(langConvert("lang.msgOrderExpiredPleaseOrderAgain",""));$("#btn_submit").attr("disabled",true)}},1000)}else{controllerComm.alertError("<p>"+langConvert("lang.msgPleaseLogin","")+"</p>",function(){$(location).attr("href","/account/signin")})}})})}$("#btn_submit-cancel").click(function(){setTimeout(function(){clearInterval(timerThread)},0)});var userTradeOrderCancel=function(a,b){Account.isLogined(function(e){if(e){$("#od_id_"+a).attr("disabled",true);var c={result:0,currency:get_channel.currency,link:{proc:"/gettradeorder"+get_channel.currency+"/cancel/"}};var d="";if(b=="buy"){d=langConvert("lang.commonBid","")}else{if(b=="sell"){d=langConvert("lang.commonAsk","")}}controllerForm.setBeanData(c);controllerForm.userTradeOrderCancel(a,function(f){$("#tradeOrder").hide();if(f&&f!="undefined"){SendEvent.sendTradeRegist();if(f.result>0){controllerComm.alertError("<p>"+d+langConvert("lang.msgCancellationRequestHasBeenProcessed","")+"</p><p>"+langConvert("lang.msgUsedThanks","")+"</p>",function(){listPageSet.current_page=1;initListData();initBalance()})}else{controllerComm.alertError("<p>"+d+langConvert("lang.msgCancelTheRequestFailed","")+"</p><p>"+f.error+"</p>",function(){document.location.reload()})}}else{controllerComm.alertError("<p>"+d+langConvert("lang.msgCancelTheRequestFailed","")+"</p><p>"+langConvert("lang.msgUsedThanks","")+"</p>",function(){document.location.reload()})}})}else{controllerComm.alertError("<p>"+langConvert("lang.msgPleaseLogin","")+"</p>",function(){$(location).attr("href","/account/signin")})}})};$(".input-calculation").on("input keypress keyup change",$(this),function(){var c=/^(\d*\.?\d{0,8})$|^\$?[\d,]+(\d*)?$/g;var a=$(this).val();if(c.test(a)){var d=a.match(c);for(var b in d){displayInputAmount()}}else{if(isNaN($(this).val())){$(this).val(a.slice(0,-1));return false}else{$(this).val(a.slice(0,-1));return false}}});$("#order-form-buy #btn_max").click(function(){var b=(domObjSet.fromarea.find(".mb_krw_poss").text()).toInteger();if(b>0){if(domObjSet.buy_price.val().replace(/[^0-9]/g,"")>0){var a=(b/domObjSet.buy_price.val().replace(/[^0-9]/g,"")).formatBitcoin();domObjSet.buy_amount.val(a);domObjSet.buy_total.val(b);domObjSet.buy_amount.focus();displayInputAmount()}}});$("#order-form-sell #btn_max").click(function(){var a=(domObjSet.fromarea.find(".mb_"+get_channel.currency+"_poss").text()).formatBitcoin();if(a>0){domObjSet.sell_amount.val(a);domObjSet.sell_amount.focus()}displayInputAmount()});$(document).on("click",".bs-dropdown-to-select-group #list_krw_price li",function(b){var a=$(b.currentTarget);a.closest(".bs-dropdown-to-select-group").find('[data-bind="bs-sel-value"]').val(a.attr("data-value")).end().children(".dropdown-toggle").dropdown("toggle");tradePageSet.float_price=parseFloat(a.attr("data-value"));displayInputAmount();return false});$(document).on("click",".bs-dropdown-to-select-group #list_btc_price li",function(b){var a=$(b.currentTarget);a.closest(".bs-dropdown-to-select-group").find('[data-bind="bs-sel-value"]').val(a.attr("data-value")).end().children(".dropdown-toggle").dropdown("toggle");tradePageSet.float_btc=parseFloat(a.attr("data-value"));displayInputAmount();return false});$("#toggle_krw").click(function(){setTimeout(function(){$("ul.list-trademarketcostvalue").scrollTop(250)},1)});$("#arrow_up_coin").click(function(){tradePageSet.code="buy";tradePageSet.arrow_coin_status=true;domObjSet.buy_amount.val((parseFloat(domObjSet.buy_amount.val())+parseFloat(tradePageSet.trade_call_unit_coin)).toFixed(8));displayInputAmount();tradePageSet.arrow_coin_status=false});$("#arrow_down_coin").click(function(){tradePageSet.code="buy";tradePageSet.arrow_coin_status=true;if(parseFloat(domObjSet.buy_amount.val())-parseFloat(tradePageSet.trade_call_unit_coin)<=0){domObjSet.buy_amount.val((0).toFixed(8))}else{domObjSet.buy_amount.val((parseFloat(domObjSet.buy_amount.val())-parseFloat(tradePageSet.trade_call_unit_coin)).toFixed(8))}displayInputAmount();tradePageSet.arrow_coin_status=false});$("#arrow_up_krw").click(function(){tradePageSet.code="buy";tradePageSet.arrow_krw_status=true;domObjSet.buy_price.val((parseInt(domObjSet.buy_price.val().replace(/[^0-9]/g,""))+parseInt(tradePageSet.trade_call_unit_krw)).formatWon());displayInputAmount();tradePageSet.arrow_krw_status=false});$("#arrow_down_krw").click(function(){tradePageSet.code="buy";tradePageSet.arrow_krw_status=true;if(parseInt(domObjSet.buy_price.val().replace(/[^0-9]/g,""))-parseInt(tradePageSet.trade_call_unit_krw)<=0){domObjSet.buy_price.val(0)}else{domObjSet.buy_price.val((parseInt(domObjSet.buy_price.val().replace(/[^0-9]/g,""))-parseInt(tradePageSet.trade_call_unit_krw)).formatWon())}displayInputAmount();tradePageSet.arrow_krw_status=false});$("#arrow_up_coin_sell").click(function(){tradePageSet.code="sell";tradePageSet.arrow_coin_sell_status=true;domObjSet.sell_amount.val((parseFloat(domObjSet.sell_amount.val())+parseFloat(tradePageSet.trade_call_unit_coin)).toFixed(8));displayInputAmount();tradePageSet.arrow_coin_sell_status=false});$("#arrow_down_coin_sell").click(function(){tradePageSet.code="sell";tradePageSet.arrow_coin_sell_status=true;if(parseFloat(domObjSet.sell_amount.val())-parseFloat(tradePageSet.trade_call_unit_coin)<=0){domObjSet.sell_amount.val((0).toFixed(8))}else{domObjSet.sell_amount.val((parseFloat(domObjSet.sell_amount.val())-parseFloat(tradePageSet.trade_call_unit_coin)).toFixed(8))}displayInputAmount();tradePageSet.arrow_coin_sell_status=false});$("#arrow_up_krw_sell").click(function(){tradePageSet.code="sell";tradePageSet.arrow_krw_sell_status=true;domObjSet.sell_price.val((parseInt(domObjSet.sell_price.val().replace(/[^0-9]/g,""))+parseInt(tradePageSet.trade_call_unit_krw)).formatWon());displayInputAmount();tradePageSet.arrow_krw_sell_status=false});$("#arrow_down_krw_sell").click(function(){tradePageSet.code="sell";tradePageSet.arrow_krw_sell_status=true;if(parseInt(domObjSet.sell_price.val().replace(/[^0-9]/g,""))-parseInt(tradePageSet.trade_call_unit_krw)<=0){domObjSet.sell_price.val(0)}else{domObjSet.sell_price.val((parseInt(domObjSet.sell_price.val().replace(/[^0-9]/g,""))-parseInt(tradePageSet.trade_call_unit_krw)).formatWon())}displayInputAmount();tradePageSet.arrow_krw_sell_status=false});$(".input-rounding-krw").focusout(function(){if(tradePageSet.code=="buy"){domObjSet.buy_price.val((domObjSet.buy_price.val()).formatWon())}else{if(tradePageSet.code=="sell"){domObjSet.sell_price.val((domObjSet.sell_price.val()).formatWon())}}});$(".only-coin").focusout(function(){if(tradePageSet.code=="buy"){if(domObjSet.buy_amount.val()>0){domObjSet.buy_amount.val((domObjSet.buy_amount.val()).formatBitcoin())}else{domObjSet.buy_amount.val("0.00000000")}}else{if(tradePageSet.code=="sell"){if(domObjSet.sell_amount.val()>0){domObjSet.sell_amount.val((domObjSet.sell_amount.val()).formatBitcoin())}else{domObjSet.sell_amount.val("0.00000000")}}}});var preTradeSellMarketCostListArray=[];var preTradeBuyMarketCostListArray=[];var cfg_chart_vmin_cost,cfg_chart_vmax_cost;var clearBuySellAnimationClass=function(a){setTimeout(function(){$("#sellbuy-orderbooks #"+a).removeClass("animated")},3000)};var clearBuySellAnimationClassDomObj=function(a){setTimeout(function(){a.removeClass("animated")},3000)};var clearTradeAnimationClass=function(a){setTimeout(function(){$("#market-trade-his #"+a).removeClass("animated")},3000)};var domTradeBuyMarket=[];var domTradeSellMarket=[];var initTradeBuySellMarketDom=function(e){var a=10;var c="";for(var b=0;b<a;b++){var d="order_list_"+e+b;if(e=="buy"){domTradeBuyMarket[b]=$("#"+d)}else{if(e=="sell"){domTradeSellMarket[b]=$("#"+d)}}}};initTradeBuySellMarketDom("buy");initTradeBuySellMarketDom("sell");var tradeBuySellMarketCostList=function(j,k){var a=domTradeBuyMarket;if(j=="sell"){a=domTradeSellMarket}var d=0;var g;try{g=$.parseJSON(k)}catch(h){}var b=10;var c=[];for(var f=0;f<b;f++){if(!g||!g.hasOwnProperty(f)){a[f].find(".p").html("");a[f].find(".a").html("");a[f].find(".s").html("");continue}compare_data=g[f][0]+"-"+g[f][1];if(j=="buy"){d=preTradeBuyMarketCostListArray.indexOf(compare_data);if(preTradeBuyMarketCostListArray.length==0){d=0}}else{if(j=="sell"){d=preTradeSellMarketCostListArray.indexOf(compare_data);if(preTradeSellMarketCostListArray.length==0){d=0}}}if(d===-1){a[f].removeClass("animated").addClass("animated");clearBuySellAnimationClassDomObj(a[f])}a[f].find(".p").html((g[f][0]+"").formatBitcoin());if(j=="sell"){a[f].find(".p").removeClass("buy");a[f].find(".p").addClass("sell")}else{a[f].find(".p").removeClass("sell");a[f].find(".p").addClass("buy")}var l=Number(g[f][0])*Number(g[f][1]);a[f].find(".a").html((g[f][1]+"").formatBitcoin());a[f].find(".s").html((l+"").formatBitcoin());c.push(compare_data)}if(j=="buy"){preTradeBuyMarketCostListArray=c}else{if(j=="sell"){preTradeSellMarketCostListArray=c}}};function onWriteChangeMyBalance(a){if(typeof tradePageSet==="undefined"||!a||!Array.isArray(a)){return}}var isFirstLoad=true;function onTickerEvent(a){}var onTickerMyTradeComEvent=function(a){setTimeout("getListOpenorder()",500);setTimeout("getListMyTradeComplet()",1500)};var onTickerTradeEvent=function(e,g){var a;var f;if(e=="{}"){a=[[0,0,0,"buy"]]}else{a=$.parseJSON(e);if(a!=null){for(var c=0;c<a.length;c++){a[c].push("buy")}}else{a=[[0,0,0,"buy"]]}}if(g=="{}"){f=[[0,0,0,"sell"]]}else{f=$.parseJSON(g);if(f!=null){for(var c=0;c<f.length;c++){f[c].push("sell")}}else{f=[[0,0,0,"sell"]]}}var b=f.reverse().concat(a);var d=JSON.stringify(b);tradeMarketCostList(d);if(isFirstLoad){setOnceInitForm(e,g);isFirstLoad=false;setOnceInitForm=null}};var onTickerMarketDepsEvent=function(a){if(typeof onChartDrawMarketDeps==="function"){onChartDrawMarketDeps(a)}};var onTickerTradeComEvent=function(a){if(typeof onTradeList==="function"){onTradeList(a)}if(typeof onRealTradeList==="function"){onRealTradeList(a)}};var setOnceInitForm=function(b,a){var c=[],d=[];try{c=$.parseJSON(b);d=$.parseJSON(a)}catch(f){}if(c==true){c.reverse()}domObjSet.buy_price.removeAttr("readonly",false);domObjSet.buy_amount.removeAttr("readonly",false);domObjSet.sell_price.removeAttr("readonly",false);domObjSet.sell_amount.removeAttr("readonly",false);if(c&&Array.isArray(c)&&c.hasOwnProperty(0)&&c[0].length>1){domObjSet.sell_price.val((parseInt(c[0][0])).formatWon())}else{domObjSet.sell_price.val(0)}if(d&&Array.isArray(d)&&d.hasOwnProperty(0)&&d[0].length>1){domObjSet.buy_price.val((parseInt(d[0][0])).formatWon())}else{domObjSet.buy_price.val(0)}};var onTradeList=function(c){var f=$.parseJSON(c);var h=[];var b="";var g=8;var e=false;if(typeof onChartDataChange==="function"){e=true}if(f!=null){for(var a=0;a<g;a++){if(e&&preChartData<f[a][0]){onChartDataChange(f[a])}var d="";if(typeof f[a]!=="undefined"){if(f[a][1]=="buy"){d="red"}else{if(f[a][1]=="sell"){d="blue"}}b='<tr class="'+d+'">';b+="<td>"+(f[a][2]).formatWon()+"</td>";b+="<td>"+(f[a][3]).formatBitcoin()+"<td>";b+="</tr>";h.push(b)}else{b="<tr>";b+="<td></td>";b+="<td></td>";b+="<td><td>";b+="</tr>"}if(a==0){chartData=f[a][0]}}preChartData=chartData}else{b="<tr><td>"+langConvert("lang.viewEmptyData","")+"</td></tr>";h.push(b)}$(".list-tradevolume tbody").html(h.join())};var onRealTradeList=function(d){var f=$.parseJSON(d);var h=[];var c="";var g=50;var a="";if(f!=null){for(var b=0;b<g;b++){var e="";if(typeof f[b]!=="undefined"){if(f[b][1]=="buy"){e="red";a=langConvert("lang.commonBid","")}else{if(f[b][1]=="sell"){e="blue";a=langConvert("lang.commonAsk","")}}c='<tr class="'+e+'">';c+="<td>"+a+"</td>";c+="<td>"+f[b][4].substr(10,9)+"</td>";c+="<td>"+(f[b][2]).formatWon()+"</td>";c+="<td>"+(f[b][3]).formatBitcoin()+"<td>";c+="</tr>";h.push(c)}else{c="<tr>";c+="<td></td>";c+="<td></td>";c+="<td><td>";c+="</tr>"}}}else{c="<tr><td>"+langConvert("lang.viewEmptyData","")+"</td></tr>";h.push(c)}$(".list-realtradevolume tbody").html(h.join())};