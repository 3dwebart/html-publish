
var timerThread=null;var count=21;var isDebug=true;var chartData=0;var preChartData=0;if(typeof(jsonObject.channel)!=="undefined"&&jsonObject.channel){var get_channel=$.parseJSON($.base64.decode(jsonObject.channel))}var listPageSet={totalcount:0,rowlimit:0,current_page:1,page_block:5,total_page:null,total_block:null,current_block:null};function initOrderCompleteListData(){Account.isLogined(function(b){if(b){var a=Utils.getTimeStamp();$.getJSON("/gettradeorder"+get_channel.currency+"/envliststradecomplete/t-"+a,"",function(c){}).done(function(d){var c=(d)?d.length:0;for(i=0;i<c;i++){if(typeof(d[i].rowlimit)=="undefined"){}else{listPageSet.totalcount=parseInt(d[0].totalcount);listPageSet.rowlimit=parseInt(d[0].rowlimit);listPageSet.total_page=calfloat("CEIL",listPageSet.totalcount/listPageSet.rowlimit,0);listPageSet.total_block=calfloat("CEIL",listPageSet.total_page/listPageSet.page_block,0);listPageSet.current_block=calfloat("CEIL",(listPageSet.current_page)/listPageSet.page_block,0);var e=(($("#list-complet-page").length>0)?($("#list-complet-page").offset().top):false);init_pager(getListMyTradeComplete,e)}}setTimeout("getListMyTradeComplete()",200)})}})}function initOrderUnCompleteListData(){Account.isLogined(function(b){if(b){var a=Utils.getTimeStamp();$.getJSON("/gettradeorder"+get_channel.currency+"/envlistopenorder/t-"+a,"",function(c){}).done(function(d){var c=(d)?d.length:0;for(i=0;i<c;i++){if(typeof(d[i].rowlimit)=="undefined"){}else{listPageSet.totalcount=parseInt(d[0].totalcount);listPageSet.rowlimit=parseInt(d[0].rowlimit);listPageSet.total_page=calfloat("CEIL",listPageSet.totalcount/listPageSet.rowlimit,0);listPageSet.total_block=calfloat("CEIL",listPageSet.total_page/listPageSet.page_block,0);listPageSet.current_block=calfloat("CEIL",(listPageSet.current_page)/listPageSet.page_block,0);var e=(($("#list-uncomplet-page").length>0)?($("#list-uncomplet-page").offset().top):false);init_pager(getListOpenorder,e)}}setTimeout("getListOpenorder()",100)})}})}function getListMyTradeComplete(a){Account.isLogined(function(d){if(d){if(!a){a=1}var b=Utils.getTimeStamp();var c="t-"+b+"/&page="+a+"/";$.getJSON("/gettradeorder"+get_channel.currency+"/liststradecomplete/"+c,"",function(e){}).done(function(e){list_write_com_content(e)})}})}var list_write_com_content=function(f){var h=[];var j="";var l="";var k="";if(typeof(f)!="undefined"){if(parseInt(f[0].result)>0){for(var g=0;g<f.length;g++){var o=calfloat("FLOOR",f[g].od_total_cost,0);var d=parseFloat(f[g].od_receipt_fee);var b=parseFloat(f[g].od_receipt_avg)*parseFloat(f[g].od_receipt_coin);b=(b.toFixed(0)).formatNumber();if(f[g].od_action=="buy"){l='<td><span class="badge buy">'+langConvert("lang.commonBid","")+"</span></td>";d=d.toFixed(8)}else{if(f[g].od_action=="sell"){l='<td><span class="badge sell">'+langConvert("lang.commonAsk","")+"</span></td>";d=d.toFixed(0);d=(d+"").toString().formatNumber()}}var m=f[g].od_reg_dt;m=m.substring(2,m.length);var n=m.split(" ");var a=n[0];var c=n[1];var e=f[g].od_receipt_dt;e=e.substring(2,e.length);j='<tr id="'+f[g].od_action+"_"+f[g].od_id+'">';j+=l;j+="<td>"+a+"<br class=only-m> "+c+"</td>";j+="<td>"+(f[g].od_market_price).formatWon()+"</td>";j+="<td>"+(f[g].od_temp_coin).formatBitcoin()+"</td>";j+="<td></td>";j+="<td>"+d+"</td>";j+="<td>"+(f[g].od_receipt_coin).formatBitcoin()+"</td>";j+="<td>"+(f[g].od_receipt_avg).formatWon()+"</td>";j+="<td>"+b+"</td>";j+="<td onClick=\"getComList('"+f[g].od_id+"','"+f[g].od_action+'\')" style="cursor:pointer"><i class=xi-plus-circle></i></td>';j+="</tr>";h.push(j)}}else{j='<tr><td colspan="10" height="60"><center>'+langConvert("lang.msgThereAreNoRecentTransactionHistory","")+"</center></td></tr>";h.push(j)}}else{j='<tr><td colspan="10" height="60"><center>'+langConvert("lang.msgThereAreNoRecentTransactionHistory","")+"</center></td></tr>";h.push(j)}$("table.list-tradecomplete>tbody").html(h.join())};function getListOpenorder(a){console.log(123);Account.isLogined(function(d){if(d){if(!a){a=1}var b=Utils.getTimeStamp();var c="t-"+b+"/&page="+a+"/";$.getJSON("/gettradeorder"+get_channel.currency+"/listsopenorder/"+c,"",function(e){}).done(function(e){list_write_uncom_content(e)})}})}var list_write_uncom_content=function(e){var g=[];var h="";if(typeof(e)!="undefined"){if(parseInt(e[0].result)>0){for(var f=0;f<e.length;f++){var c="";var l=0;if(parseFloat(e[f].od_receipt_coin)>0){l=e[f].od_receipt_coin}else{l=(0).toFixed(8)}var j=e[f].od_receipt_avg*e[f].od_receipt_coin;j=(parseInt(j)).toString().formatNumber();if((e[f].od_pay_status=="REQ")&&e[f].od_receipt_coin==0){c='<span class="od_id_o_btnc_'+e[f].od_id+'"><button type="button" class="btn-cancle" id="od_id_'+e[f].od_id+'" onClick="userTradeOrderCancel('+e[f].od_id+",'"+e[f].od_action+"')\">"+langConvert("lang.msgTradeOrdersCancel","")+"</button></span>"}else{if(parseFloat(e[f].od_receipt_coin)>0){c='<span class="od_id_o_btnc_'+e[f].od_id+'"><button type="button" class="btn-cancle" id="od_id_'+e[f].od_id+'" onClick="userTradeOrderCancel('+e[f].od_id+",'"+e[f].od_action+"')\">"+langConvert("lang.msgTradeOrdersCancel","")+"</button></span>"}else{c=langConvert("lang.commonTradeProgress","")+' <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>'}}h="<tr>";if(e[f].od_action=="buy"){h+='<td><span class="badge buy">'+langConvert("lang.commonBid","")+"</span></td>"}else{if(e[f].od_action=="sell"){h+='<td><span class="badge sell">'+langConvert("lang.commonAsk","")+"</span></td>"}}var k=e[f].od_reg_dt;k=k.substring(2,k.length);var d=k.split(" ");var a=d[0];var b=d[1];h+="<td>"+a+"<br class=only-m> "+b+"</td>";h+="<td>"+(e[f].od_market_price).formatWon()+"</td>";h+="<td>"+(e[f].od_temp_coin).formatBitcoin()+"</td>";h+="<td>"+l+"</td>";h+="<td>"+(parseFloat(e[f].od_temp_coin)-parseFloat(e[f].od_receipt_coin)).formatBitcoin()+"</td>";h+="<td>"+(e[f].od_receipt_avg).formatWon()+"</td>";h+="<td>"+j+"</td>";h+="<td>"+c+"</td>";h+="</tr>";g.push(h)}}else{h='<tr><td colspan="9" height="60"><center>'+langConvert("lang.msgNoOrdersHaveAlreadyConcludedHistory","")+"</center></td></tr>";g.push(h)}}else{h='<tr><td colspan="9" height="60"><center>'+langConvert("lang.msgNoOrdersHaveAlreadyConcludedHistory","")+"</center></td></tr>";g.push(h)}$("table.list-tradenocomplete>tbody").html(g.join())};function getComList(e,f,a){if(typeof a==="undefined"){a="com"}else{a="uncom"}if($("."+f+"_"+e+"_detail").length>0){var g=$("."+f+"_"+e+"_detail").css("display");if(g=="table-row"){$("."+f+"_"+e+"_detail").css("display","none")}else{$("."+f+"_"+e+"_detail").css("display","table-row")}}else{var d=get_channel.currency;var c=f+"_krw_"+d;var b="";$.getJSON("/gettradelist/select/odid-"+e+"/action-"+c+"/","",function(h){}).success(function(p){if(typeof(p)!=="undefined"){if(parseInt(p[0].result)>0){var n=1;for(var q=0;q<p.length;q++){var j=p[q].po_reg_dt;j=j.substring(2,j.length);var o=j.split(" ");var h=o[0];var l=o[1];var m=p[q].po_point;m=Math.abs(m);var r=parseFloat(m)/parseFloat(p[q].od_total_cost);if(a=="uncom"){b+='<tr class="more '+f+"_"+e+'_detail" style="display:table-row;">';b+="<td></td>";b+="<td></td>";b+="<td></td>";b+="<td></td>";b+="<td>("+n+") "+h+"<br class=only-m> "+l+"</td>";b+="<td></td>";b+="<td>"+p[q].od_total_cost+"</td>";b+="<td>"+calfloat("FLOOR",r,0).formatWon()+"</td>";b+="<td>"+parseInt(m).formatWon()+"</td>";b+="<td></td>";b+="</tr>"}else{b+='<tr class="more '+f+"_"+e+'_detail" style="display:table-row;">';b+="<td></td>";b+="<td></td>";b+="<td></td>";b+="<td></td>";b+="<td>("+n+") "+h+"<br class=only-m> "+l+"</td>";b+="<td></td>";b+="<td>"+p[q].od_total_cost+"</td>";b+="<td>"+calfloat("FLOOR",r,0).formatWon()+"</td>";b+="<td>"+parseInt(m).formatWon()+"</td>";b+="<td></td>";b+="</tr>"}n++}}}else{}$("#"+f+"_"+e).after(b)})}}var userTradeOrderCancel=function(a,b){Account.isLogined(function(e){if(e){$("#od_id_"+a).attr("disabled",true);var c={result:0,currency:get_channel.currency,link:{proc:"/gettradeorder"+get_channel.currency+"/cancel/"}};var d="";if(b=="buy"){d=langConvert("lang.commonBid","")}else{if(b=="sell"){d=langConvert("lang.commonAsk","")}}controllerForm.setBeanData(c);controllerForm.userTradeOrderCancel(a,function(f){$("#tradeOrder").hide();if(f&&f!="undefined"){SendEvent.sendTradeRegist();if(f.result>0){controllerComm.alertError("<p>"+d+langConvert("lang.msgCancellationRequestHasBeenProcessed","")+"</p><p>"+langConvert("lang.msgUsedThanks","")+"</p>",function(){listPageSet.current_page=1;initListData();initBalance()})}else{controllerComm.alertError("<p>"+d+langConvert("lang.msgCancelTheRequestFailed","")+"</p><p>"+f.error+"</p>",function(){document.location.reload()})}}else{controllerComm.alertError("<p>"+d+langConvert("lang.msgCancelTheRequestFailed","")+"</p><p>"+langConvert("lang.msgUsedThanks","")+"</p>",function(){document.location.reload()})}})}else{controllerComm.alertError("<p>"+langConvert("lang.msgPleaseLogin","")+"</p>",function(){$(location).attr("href","/account/signin")})}})};var onTickerMyTradeComEvent=function(a){setTimeout("getListOpenorder()",500);setTimeout("getListMyTradeComplete()",1500)};